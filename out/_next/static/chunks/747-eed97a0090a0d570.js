"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[747],{6424:(e,t,a)=>{a.d(t,{$:()=>i,F:()=>d});var r=a(5155),s=a(2115),n=a(7655),l=a(9434);let d=s.forwardRef((e,t)=>{let{className:a,children:s,...d}=e;return(0,r.jsxs)(n.bL,{ref:t,className:(0,l.cn)("relative overflow-hidden",a),...d,children:[(0,r.jsx)(n.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,r.jsx)(i,{}),(0,r.jsx)(n.OK,{})]})});d.displayName=n.bL.displayName;let i=s.forwardRef((e,t)=>{let{className:a,orientation:s="vertical",...d}=e;return(0,r.jsx)(n.VM,{ref:t,orientation:s,className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...d,children:(0,r.jsx)(n.lr,{className:"relative flex-1 rounded-full bg-border"})})});i.displayName=n.VM.displayName},9409:(e,t,a)=>{a.d(t,{bq:()=>u,eb:()=>x,gC:()=>h,l6:()=>c,yv:()=>m});var r=a(5155),s=a(2115),n=a(1721),l=a(9556),d=a(7381),i=a(518),o=a(9434);let c=n.bL;n.YJ;let m=n.WT,u=s.forwardRef((e,t)=>{let{className:a,children:s,...d}=e;return(0,r.jsxs)(n.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...d,children:[s,(0,r.jsx)(n.In,{asChild:!0,children:(0,r.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=n.l9.displayName;let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(d.A,{className:"h-4 w-4"})})});f.displayName=n.PP.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})});p.displayName=n.wn.displayName;let h=s.forwardRef((e,t)=>{let{className:a,children:s,position:l="popper",...d}=e;return(0,r.jsx)(n.ZL,{children:(0,r.jsxs)(n.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...d,children:[(0,r.jsx)(f,{}),(0,r.jsx)(n.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(p,{})]})})});h.displayName=n.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})}).displayName=n.JU.displayName;let x=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(n.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.VF,{children:(0,r.jsx)(i.A,{className:"h-4 w-4"})})}),(0,r.jsx)(n.p4,{children:s})]})});x.displayName=n.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=n.wv.displayName},9747:(e,t,a)=>{a.d(t,{R:()=>T});var r=a(5155),s=a(2115),n=a(3013),l=a(6872),d=a(9591),i=a(1920),o=a(2177),c=a(221),m=a(5594),u=a(9434),f=a(28),p=a(2617),h=a(7481),x=a(8382),g=a(285),j=a(2523),y=a(8176);let b=y.bL,v=y.l9,w=s.forwardRef((e,t)=>{let{className:a,align:s="center",sideOffset:n=4,...l}=e;return(0,r.jsx)(y.ZL,{children:(0,r.jsx)(y.UC,{ref:t,align:s,sideOffset:n,className:(0,u.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});w.displayName=y.UC.displayName;var N=a(965),C=a(3158),I=a(9445);function _(e){let{className:t,classNames:a,showOutsideDays:s=!0,...n}=e;return(0,r.jsx)(I.hv,{showOutsideDays:s,className:(0,u.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,u.cn)((0,g.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,u.cn)((0,g.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:t,...a}=e;return(0,r.jsx)(N.A,{className:(0,u.cn)("h-4 w-4",t),...a})},IconRight:e=>{let{className:t,...a}=e;return(0,r.jsx)(C.A,{className:(0,u.cn)("h-4 w-4",t),...a})}},...n})}_.displayName="Calendar";var z=a(704);let R=z.bL,A=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(z.B8,{ref:t,className:(0,u.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...s})});A.displayName=z.B8.displayName;let k=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(z.l9,{ref:t,className:(0,u.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...s})});k.displayName=z.l9.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(z.UC,{ref:t,className:(0,u.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...s})}).displayName=z.UC.displayName;var M=a(6424),L=a(5937),V=a(9409);let S=m.z.object({type:m.z.enum(["income","expense"]),amount:m.z.coerce.number().min(1,{message:"Số tiền phải lớn hơn 0."}),description:m.z.string().min(1,{message:"M\xf4 tả kh\xf4ng được để trống."}),tagId:m.z.string({required_error:"Vui l\xf2ng chọn một hạng mục."}),walletId:m.z.string({required_error:"Vui l\xf2ng chọn một v\xed."}),createdAt:m.z.date()}),U=e=>{let{tag:t,isSelected:a,onClick:s}=e,n=l[t.icon];return(0,r.jsxs)("button",{type:"button",onClick:s,className:(0,u.cn)("flex flex-col items-center justify-center space-y-1 p-2 border rounded-lg w-20 h-20 flex-shrink-0 transition-all",a?"border-primary ring-2 ring-primary bg-primary/10":"border-border"),children:[(0,r.jsx)("div",{className:(0,u.cn)("flex items-center justify-center h-8 w-8 rounded-full",t.bgColor),children:n&&(0,r.jsx)(n,{className:(0,u.cn)("w-5 h-5",t.textColor)})}),(0,r.jsx)("span",{className:"text-xs text-center",children:t.name})]},t.id)};function T(e){var t;let{isOpen:a,onOpenChange:l,transaction:m}=e,[u,y]=(0,p.M)("transactions",[]),[N]=(0,p.M)("wallets",f.f),[C]=(0,p.M)("tags",f.Gp),[I]=(0,p.M)("selectedWalletId",null==(t=N[0])?void 0:t.id),{toast:z}=(0,h.dj)(),T=!!m,B=(0,o.mN)({resolver:(0,c.u)(S)});(0,s.useEffect)(()=>{if(a)if(T&&m)B.reset({type:m.type,amount:m.amount,description:m.description,createdAt:new Date(m.createdAt),walletId:m.walletId,tagId:m.tagId});else{var e;B.reset({type:"expense",amount:0,description:"",createdAt:new Date,walletId:I||(null==(e=N[0])?void 0:e.id),tagId:void 0})}},[a,m,T,I,N,B]);let q=B.watch("type");return(0,r.jsx)(x.cj,{open:a,onOpenChange:l,children:(0,r.jsxs)(x.h,{side:"bottom",className:"rounded-t-lg max-h-[90vh] flex flex-col p-0",children:[(0,r.jsxs)(x.Fm,{className:"p-6 pb-0",children:[(0,r.jsx)(x.qp,{children:T?"Cập nhật giao dịch":"Th\xeam giao dịch mới"}),(0,r.jsx)(x.Qs,{children:T?"Chỉnh sửa th\xf4ng tin giao dịch của bạn.":"Th\xeam một khoản thu hoặc chi mới v\xe0o sổ của bạn."})]}),(0,r.jsx)(L.lV,{...B,children:(0,r.jsxs)("form",{onSubmit:B.handleSubmit(function(e){if(T&&m){let t={...m,...e,createdAt:e.createdAt.toISOString()};y(u.map(e=>e.id===m.id?t:e)),z({title:"Th\xe0nh c\xf4ng!",description:"Đ\xe3 cập nhật giao dịch."})}else y([{id:crypto.randomUUID(),...e,createdAt:e.createdAt.toISOString()},...u]),z({title:"Th\xe0nh c\xf4ng!",description:"Đ\xe3 th\xeam giao dịch mới."});l(!1)}),className:"flex-1 overflow-y-auto px-6 space-y-4",children:[(0,r.jsx)(L.zB,{control:B.control,name:"type",render:e=>{let{field:t}=e;return(0,r.jsx)(R,{value:t.value,onValueChange:e=>{if(!T&&(t.onChange(e),B.setValue("tagId",""),"income"===e)){let e=C.find(e=>"Thu nhập"===e.name);e&&B.setValue("tagId",e.id)}},className:"w-full pt-4",children:(0,r.jsxs)(A,{className:"grid w-full grid-cols-2",children:[(0,r.jsx)(k,{value:"expense",disabled:T&&(null==m?void 0:m.type)==="income",children:"Chi tiền"}),(0,r.jsx)(k,{value:"income",disabled:T&&(null==m?void 0:m.type)==="expense",children:"Thu tiền"})]})})}}),(0,r.jsx)(L.zB,{control:B.control,name:"amount",render:e=>{let{field:t}=e;return(0,r.jsxs)(L.eI,{children:[(0,r.jsx)(L.lR,{children:"Số tiền"}),(0,r.jsx)(L.MJ,{children:(0,r.jsx)(j.p,{...t,type:"number",placeholder:"0",className:"text-lg h-14 font-bold text-right"})}),(0,r.jsx)(L.C5,{})]})}}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(L.zB,{control:B.control,name:"walletId",render:e=>{let{field:t}=e;return(0,r.jsxs)(L.eI,{children:[(0,r.jsx)(L.lR,{children:"V\xed"}),(0,r.jsxs)(V.l6,{onValueChange:t.onChange,value:t.value,children:[(0,r.jsx)(L.MJ,{children:(0,r.jsxs)(V.bq,{children:[(0,r.jsx)(d.A,{className:"mr-2 h-4 w-4"}),(0,r.jsx)(V.yv,{placeholder:"Chọn v\xed"})]})}),(0,r.jsx)(V.gC,{children:N.map(e=>(0,r.jsx)(V.eb,{value:e.id,children:e.name},e.id))})]}),(0,r.jsx)(L.C5,{})]})}}),(0,r.jsx)(L.zB,{control:B.control,name:"createdAt",render:e=>{let{field:t}=e;return(0,r.jsxs)(L.eI,{children:[(0,r.jsx)(L.lR,{children:"Ng\xe0y"}),(0,r.jsxs)(b,{children:[(0,r.jsx)(v,{asChild:!0,children:(0,r.jsx)(L.MJ,{children:(0,r.jsxs)(g.$,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[(0,r.jsx)(i.A,{className:"mr-2 h-4 w-4"}),t.value?(0,n.GP)(t.value,"dd/MM/yy"):(0,r.jsx)("span",{children:"Chọn ng\xe0y"})]})})}),(0,r.jsx)(w,{className:"w-auto p-0",children:(0,r.jsx)(_,{mode:"single",selected:t.value,onSelect:t.onChange,initialFocus:!0})})]}),(0,r.jsx)(L.C5,{})]})}})]}),(0,r.jsx)(L.zB,{control:B.control,name:"description",render:e=>{let{field:t}=e;return(0,r.jsxs)(L.eI,{children:[(0,r.jsx)(L.lR,{children:"M\xf4 tả"}),(0,r.jsx)(L.MJ,{children:(0,r.jsx)(j.p,{...t,placeholder:"VD: Ăn trưa"})}),(0,r.jsx)(L.C5,{})]})}}),(0,r.jsx)(L.zB,{control:B.control,name:"tagId",render:e=>{let{field:t}=e;return(0,r.jsxs)(L.eI,{children:[(0,r.jsx)(L.lR,{children:"Chọn hạng mục"}),(0,r.jsxs)(M.F,{className:"w-full whitespace-nowrap -mx-2 px-2",children:[(0,r.jsx)("div",{className:"flex w-max space-x-2 py-2",children:C.filter(e=>"income"===q?"Thu nhập"===e.name:"Thu nhập"!==e.name).map(e=>(0,r.jsx)(U,{tag:e,isSelected:t.value===e.id,onClick:()=>t.onChange(e.id)},e.id))}),(0,r.jsx)(M.$,{orientation:"horizontal"})]}),(0,r.jsx)(L.C5,{})]})}}),(0,r.jsx)(x.XW,{className:"pt-4 sticky bottom-0 bg-background pb-6",children:(0,r.jsx)(g.$,{type:"submit",className:"w-full",children:T?"Lưu thay đổi":"Lưu giao dịch"})})]})})]})})}}}]);